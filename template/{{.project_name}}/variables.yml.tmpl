variables:
  # ================================================
  # Unity Catalog Configuration
  # ================================================
  catalog_name:
    description: Unity Catalog name (override per target in databricks.yml)
    default: "user_${workspace.current_user.short_name}_{{.uc_catalog_suffix}}"

  default_schema_name:
    description: Default schema for resources
    default: "bronze"

  # ================================================
  # LDP Pipeline Configuration
  # ================================================
  pipeline_min_workers:
    description: Min workers for pipeline autoscale (custom clusters only)
    default: 1

  pipeline_max_workers:
    description: Max workers for pipeline autoscale (custom clusters only)
    default: 4

  photon_enabled:
    description: Enable Photon acceleration
    default: true

  continuous_mode:
    description: Run pipeline continuously (vs triggered)
    default: false

  # ================================================
  # Job Configuration
  # ================================================
  job_cluster_min_workers:
    description: Min workers for job cluster autoscale (custom clusters only)
    default: 1

  job_cluster_max_workers:
    description: Max workers for job cluster autoscale (custom clusters only)
    default: 4

  failure_notification_emails:
    description: Email addresses for job failure alerts
    default: []

  max_retries:
    description: Max retries for failed job tasks
    default: 2

  retry_interval_millis:
    description: Wait time between retries (ms)
    default: 300_000

  # ================================================
  # Service Principals (for CI/CD deployments)
  # ================================================
  # Set service principals using one of methods:
  # * Set values directly here for `default:` key
  # * CLI: databricks bundle deploy -t dev --var="dev_service_principal=<app-id>,..."
  # * Env variable: BUNDLE_VAR_dev_service_principal=<app-id>
{{- if eq .configure_sp_now "no" }}
  #
  # NOTE: Search for "SP_PLACEHOLDER" to find and replace these values
  # with your actual service principal application IDs.
{{- end }}

{{- if eq .include_dev_environment "yes" }}
  dev_service_principal:
    description: Service principal app ID for dev environment
  {{- if and (eq .configure_sp_now "yes") (ne .dev_service_principal "") }}
    default: "{{.dev_service_principal}}"
  {{- else }}
    default: "SP_PLACEHOLDER_DEV"  # Replace with your dev SP app ID
  {{- end }}
{{- end }}

  stage_service_principal:
    description: Service principal app ID for stage environment
  {{- if and (eq .configure_sp_now "yes") (ne .stage_service_principal "") }}
    default: "{{.stage_service_principal}}"
  {{- else }}
    default: "SP_PLACEHOLDER_STAGE"  # Replace with your stage SP app ID
  {{- end }}

{{- if eq .environment_setup "full" }}
  prod_service_principal:
    description: Service principal app ID for prod environment
  {{- if and (eq .configure_sp_now "yes") (ne .prod_service_principal "") }}
    default: "{{.prod_service_principal}}"
  {{- else }}
    default: "SP_PLACEHOLDER_PROD"  # Replace with your prod SP app ID
  {{- end }}
{{- end }}

{{- if eq .include_permissions "yes" }}

  # ================================================
  # User Groups (create before deployment)
  # ================================================
  # Create via: Settings → Identity and access → Groups → Add group
  # See docs/SETUP_GROUPS.md for details

  developers_group:
    description: Developer group name
    default: "developers"

  qa_team_group:
    description: QA team group name (stage access)
    default: "qa_team"

{{- if eq .environment_setup "full" }}
  operations_group:
    description: Operations team group name (prod access)
    default: "operations_team"
{{- end }}

  analytics_team_group:
    description: Analytics team group name (read access)
    default: "analytics_team"
{{- end }}
